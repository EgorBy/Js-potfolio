<meta charset="UTF-8">
<script>
    class Car{
        constructor(title,price) {
            this.title = title;
            this.price = price;
        }
    }

    class Factory{
        /**
         *
         * @param titleFactory - название завода
         */
        constructor(titleFactory) {
            this.titleFactory = titleFactory;
        }

        createCar(titleCar){
            console.log(`Началась сборка авто ${titleCar}`);
            const car = new Car(titleCar,parseInt(Math.random() * 4000 + 1000));
            return car;
        }
    }

    class Diller{
        constructor(title,years) {
            this.title = title;
            this.years = years;
        }

        /**
         *
         * @param count - количество авто для заказа
         * @param models - массив моделей, которые необходимо заказать
         * @param factory - объект завод
         */
        createOrder(count,models,factory){
            const order = new Order(count,models,factory,this);
        }
    }

    class Order{
        constructor(count,models,factory,diller) {
            this.count = count;
            this.models = models;
            this.factory = factory;
            this.diller = diller;
            this.sumOrder = 0;
            this.cars = [];
            this.start();//запустим процесс
            this.showInfo();
        }

        start() {
            for(let i = 0;i < count;i++){
                let car = this.factory.createCar(
                    this.models[parseInt(Math.random() * this.models.length)]);
                this.cars.push(car);
                this.sumOrder += car.price;
            }
        }

        showInfo() {
            this.cars.forEach(car => {
                console.log(`${car.title} стоит ${car.price}`);
            });
            if(this.diller.years > 10){
                let discaunt = this.sumOrder * 20 / 100;
                this.sumOrder -= discaunt;
                console.log(`Скидка составляет ${discaunt}`);
            }
            console.log(`Общая стоимость заказа: ${this.sumOrder}`);
        }
    }

    let models = ['Гранта','Нива','Веста'];
    let count = parseInt(Math.random() * 20 + 10);
    let factory = new Factory('АвтоВаз');
    let diller = new Diller("Элвис",2);
    diller.createOrder(count,models,factory);
</script>